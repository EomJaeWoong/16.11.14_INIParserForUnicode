#ifndef __INIPARSERFORUNICODE__H__
#define __INIPARSERFORUNICODE__H__

class CAyaINIParserUni
{
public :
	enum e_AYA_INI_PARSE
	{
		eBUFFER_SIZE = 100000
	};

	//-------------------------------------------------------------------------------
	// 생성자, 파괴자
	//-------------------------------------------------------------------------------
	CAyaINIParserUni();
	virtual ~CAyaINIParserUni();

	//-------------------------------------------------------------------------------
	// 초기화
	//-------------------------------------------------------------------------------
	void					Initial();

	//-------------------------------------------------------------------------------
	// 파일 오픈
	//-------------------------------------------------------------------------------
	BOOL					LoadFile(WCHAR *szFileName);

	//-------------------------------------------------------------------------------
	// 구역 찾기
	//-------------------------------------------------------------------------------
	BOOL					ProvideArea(WCHAR *szAreaName);

	//-------------------------------------------------------------------------------
	// GetValue - 자료형에 따른 값 얻기
	// String -> INI변수 이름, 저장될 문자열, 문자열 사이즈
	// int    -> INI변수 이름, 저장될 변수(int)
	// float  -> INI변수 이름, 저장될 변수(float)
	//-------------------------------------------------------------------------------
	BOOL					GetValue(WCHAR *szName, WCHAR *szValue, int *ipBufSize);
	BOOL					GetValue(WCHAR *szName, int *ipValue);
	BOOL					GetValue(WCHAR *szName, float *fpValue);

protected :
	//-------------------------------------------------------------------------------
	//스페이스, 탭, 엔터코드, 주석 처리
	//-------------------------------------------------------------------------------
	BOOL					SkipNoneCommand();

	//-------------------------------------------------------------------------------
	// 다음 단어 얻기
	//-------------------------------------------------------------------------------
	BOOL					GetNextWord(WCHAR **wppBuffer, int *ipLength);

	//-------------------------------------------------------------------------------
	// 문자열 읽기
	//-------------------------------------------------------------------------------
	BOOL					GetStringWord(WCHAR **wppBuffer, int *ipLength);

protected:
	//-------------------------------------------------------------------------------
	// 읽은 파일을 저장할 버퍼
	//-------------------------------------------------------------------------------
	WCHAR					*m_wpBuffer;

	//-------------------------------------------------------------------------------
	// 로드된 파일 크기
	//-------------------------------------------------------------------------------
	int						m_iLoadSize;

	//-------------------------------------------------------------------------------
	// 버퍼의 위치
	//-------------------------------------------------------------------------------
	int						m_iBufferAreaStart;					//구역 시작 위치
	int						m_iBufferAreaEnd;					//구역 끝 위치
	int						m_iBufferFocusPos;					//현재 가르키는 위치

	//-------------------------------------------------------------------------------
	// 구역 찾는중
	//-------------------------------------------------------------------------------
	BOOL					m_bProvideAreaMode;

};

#endif